"use strict";(self.webpackChunkkolajAI_frontend=self.webpackChunkkolajAI_frontend||[]).push([[792],{624:function(e,t,a){var n=a(705),i=a(83),s=a(959),o=a(968),r=a(574);class c{constructor(){this.init()}async init(){try{this.initAlpine(),this.setupAxios(),await this.initServices(),this.setupEventListeners(),this.initPWA(),this.setupPerformanceMonitoring()}catch(e){0,this.handleInitError(e)}}initAlpine(){n.A.data("app",()=>({user:null,cart:{items:[],total:0,count:0},notifications:[],isLoading:!1,mobileMenuOpen:!1,searchOpen:!1,cartOpen:!1,notificationsOpen:!1,searchQuery:"",searchResults:[],searchLoading:!1,filters:{category:"",priceRange:[0,1e3],rating:0,availability:"all"},async init(){await this.loadUser(),await this.loadCart(),await this.loadNotifications()},async loadUser(){try{const e=await window.app.authService.getCurrentUser();this.user=e.data}catch(e){}},async loadCart(){try{this.cart=await window.app.cartService.getCart()}catch(e){}},async loadNotifications(){if(this.user)try{const e=await window.app.notificationService.getNotifications();this.notifications=e.data}catch(e){}},async search(){if(this.searchQuery.trim()){this.searchLoading=!0;try{const e=await window.app.apiService.get("/api/search",{params:{q:this.searchQuery,...this.filters}});this.searchResults=e.data.results}catch(e){showToast("Arama s\u0131ras\u0131nda bir hata olu\u015ftu","error")}finally{this.searchLoading=!1}}else this.searchResults=[]},async addToCart(e,t=1){try{await window.app.cartService.addItem(e,t),await this.loadCart(),showToast("\xdcr\xfcn sepete eklendi","success")}catch(a){showToast("\xdcr\xfcn sepete eklenemedi","error")}},async removeFromCart(e){try{await window.app.cartService.removeItem(e),await this.loadCart(),showToast("\xdcr\xfcn sepetten kald\u0131r\u0131ld\u0131","info")}catch(t){showToast("\xdcr\xfcn sepetten kald\u0131r\u0131lamad\u0131","error")}},formatCurrency:formatCurrency,formatNumber:formatNumber,formatDate:e=>(0,s.A)(new Date(e),"dd MMMM yyyy",{locale:r.A}),formatTimeAgo:e=>(0,o.A)(new Date(e),{addSuffix:!0,locale:r.A}),toggleMobileMenu(){this.mobileMenuOpen=!this.mobileMenuOpen},toggleSearch(){this.searchOpen=!this.searchOpen,this.searchOpen&&this.$nextTick(()=>{var e;null===(e=this.$refs.searchInput)||void 0===e||e.focus()})},toggleCart(){this.cartOpen=!this.cartOpen},toggleNotifications(){this.notificationsOpen=!this.notificationsOpen}})),n.A.store("theme",{current:localStorage.getItem("theme")||"light",toggle(){this.current="light"===this.current?"dark":"light",localStorage.setItem("theme",this.current),document.documentElement.classList.toggle("dark","dark"===this.current)}}),n.A.store("preferences",{language:localStorage.getItem("language")||"tr",currency:localStorage.getItem("currency")||"TRY",notifications:JSON.parse(localStorage.getItem("notifications")||"true"),setLanguage(e){this.language=e,localStorage.setItem("language",e),window.location.reload()},setCurrency(e){this.currency=e,localStorage.setItem("currency",e)},toggleNotifications(){this.notifications=!this.notifications,localStorage.setItem("notifications",JSON.stringify(this.notifications))}}),n.A.start(),window.Alpine=n.A}setupAxios(){var e;i.A.defaults.baseURL=window.location.origin;const t=null===(e=document.querySelector('meta[name="csrf-token"]'))||void 0===e?void 0:e.getAttribute("content");t&&(i.A.defaults.headers.common["X-CSRF-Token"]=t);const a=localStorage.getItem("auth_token");a&&(i.A.defaults.headers.common.Authorization=`Bearer ${a}`),i.A.interceptors.request.use(e=>(e.background||document.body.classList.add("loading"),e),e=>(document.body.classList.remove("loading"),Promise.reject(e))),i.A.interceptors.response.use(e=>(document.body.classList.remove("loading"),e),e=>{var t,a,n;return document.body.classList.remove("loading"),401===(null===(t=e.response)||void 0===t?void 0:t.status)?(this.authService.logout(),showToast("Oturum s\xfcreniz doldu, l\xfctfen tekrar giri\u015f yap\u0131n","warning")):403===(null===(a=e.response)||void 0===a?void 0:a.status)?showToast("Bu i\u015flem i\xe7in yetkiniz bulunmuyor","error"):(null===(n=e.response)||void 0===n?void 0:n.status)>=500&&showToast("Sunucu hatas\u0131 olu\u015ftu, l\xfctfen daha sonra tekrar deneyin","error"),Promise.reject(e)})}async initServices(){await Promise.all([this.authService.init(),this.cartService.init(),this.notificationService.init()])}setupEventListeners(){window.addEventListener("online",()=>{showToast("\u0130nternet ba\u011flant\u0131s\u0131 yeniden kuruldu","success"),this.syncOfflineData()}),window.addEventListener("offline",()=>{showToast("\u0130nternet ba\u011flant\u0131s\u0131 kesildi","warning")}),document.addEventListener("visibilitychange",()=>{document.hidden||this.refreshData()}),window.addEventListener("beforeunload",e=>{this.savePendingData()}),document.addEventListener("keydown",e=>{(e.ctrlKey||e.metaKey)&&"k"===e.key&&(e.preventDefault(),n.A.store("app").toggleSearch()),"Escape"===e.key&&document.querySelectorAll("[x-show]").forEach(e=>{var t;null!==(t=e._x_dataStack)&&void 0!==t&&null!==(t=t[0])&&void 0!==t&&t.open&&(e._x_dataStack[0].open=!1)})})}initPWA(){let e;"serviceWorker"in navigator&&window.addEventListener("load",async()=>{try{const e=await navigator.serviceWorker.register("/sw.js");e.addEventListener("updatefound",()=>{const t=e.installing;t.addEventListener("statechange",()=>{"installed"===t.state&&navigator.serviceWorker.controller&&this.showUpdateAvailable()})})}catch(e){}}),window.addEventListener("beforeinstallprompt",t=>{t.preventDefault(),e=t,this.showInstallPrompt(e)}),window.addEventListener("appinstalled",()=>{showToast("Uygulama ba\u015far\u0131yla y\xfcklendi!","success"),e=null})}setupPerformanceMonitoring(){if("web-vital"in window&&a.e(96).then(a.bind(a,237)).then(({getCLS:e,getFID:t,getFCP:a,getLCP:n,getTTFB:i})=>{e(console.log),t(console.log),a(console.log),n(console.log),i(console.log)}),"PerformanceObserver"in window)try{new PerformanceObserver(e=>{for(const t of e.getEntries())t.duration}).observe({entryTypes:["longtask"]})}catch(e){}}handleInitError(e){const t=document.createElement("div");t.className="fixed inset-0 bg-red-50 flex items-center justify-center z-50",t.innerHTML='\n      <div class="text-center p-8">\n        <div class="text-red-600 text-6xl mb-4">\u26a0\ufe0f</div>\n        <h1 class="text-2xl font-bold text-red-800 mb-2">Uygulama Ba\u015flat\u0131lamad\u0131</h1>\n        <p class="text-red-600 mb-4">Bir hata olu\u015ftu. L\xfctfen sayfay\u0131 yenileyin.</p>\n        <button onclick="window.location.reload()" \n                class="bg-red-600 text-white px-6 py-2 rounded-lg hover:bg-red-700">\n          Sayfay\u0131 Yenile\n        </button>\n      </div>\n    ',document.body.appendChild(t)}async syncOfflineData(){try{await this.cartService.syncOfflineData(),await this.notificationService.syncOfflineData()}catch(e){}}async refreshData(){try{const e=n.A.store("app");e&&await Promise.all([e.loadCart(),e.loadNotifications()])}catch(e){}}savePendingData(){try{this.cartService.savePendingData()}catch(e){}}showUpdateAvailable(){const e=document.createElement("div");e.className="fixed top-0 left-0 right-0 bg-blue-600 text-white p-4 z-50",e.innerHTML='\n      <div class="flex items-center justify-between max-w-7xl mx-auto">\n        <span>Yeni bir s\xfcr\xfcm mevcut!</span>\n        <button onclick="window.location.reload()" \n                class="bg-blue-700 px-4 py-2 rounded hover:bg-blue-800">\n          G\xfcncelle\n        </button>\n      </div>\n    ',document.body.appendChild(e)}showInstallPrompt(e){setTimeout(()=>{const e=document.createElement("div");e.className="fixed bottom-4 right-4 bg-white shadow-lg rounded-lg p-4 max-w-sm z-50",e.innerHTML='\n        <div class="flex items-center space-x-3">\n          <div class="flex-1">\n            <h3 class="font-semibold">Uygulamay\u0131 Y\xfckle</h3>\n            <p class="text-sm text-gray-600">Daha iyi deneyim i\xe7in uygulamay\u0131 y\xfckleyin</p>\n          </div>\n          <div class="flex space-x-2">\n            <button onclick="this.parentElement.parentElement.parentElement.remove()" \n                    class="text-gray-400 hover:text-gray-600">\xd7</button>\n            <button onclick="window.app.installApp()" \n                    class="bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700">\n              Y\xfckle\n            </button>\n          </div>\n        </div>\n      ',document.body.appendChild(e)},5e3)}async installApp(){if(this.deferredPrompt){this.deferredPrompt.prompt();const{outcome:e}=await this.deferredPrompt.userChoice;this.deferredPrompt=null}}}document.addEventListener("DOMContentLoaded",()=>{window.app=new c})}},function(e){e.O(0,[96,869],function(){return t=624,e(e.s=t);var t});e.O()}]);
//# sourceMappingURL=main.e4a05c21.js.map