{{define "analytics/customers.gohtml"}}
<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{.Title}} - KolajAI</title>
    <link rel="stylesheet" href="/web/static/assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="/web/static/sass/main.css">
    <link rel="stylesheet" href="/web/static/sass/dark-theme.css">
</head>
<body>
    <div class="analytics-container">
        <!-- Header -->
        <header class="analytics-header">
            <div class="container">
                <div class="analytics-nav">
                    <div class="analytics-logo">
                        <h2>üë• M√º≈üteri Analizi</h2>
                    </div>
                    <nav class="analytics-menu">
                        <a href="/analytics/dashboard">Dashboard</a>
                        <a href="/analytics/revenue">Gelir Analizi</a>
                        <a href="/analytics/customers" class="active">M√º≈üteri Analizi</a>
                        <a href="/analytics/products">√úr√ºn Analizi</a>
                        <a href="/admin/dashboard">Admin Panel</a>
                    </nav>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="analytics-main">
            <div class="container">
                <div class="page-header">
                    <h1>{{.Title}}</h1>
                    <div class="page-actions">
                        <button class="btn btn-secondary" onclick="refreshCustomerData()">
                            <i class="icon-refresh"></i> Yenile
                        </button>
                        <button class="btn btn-primary" onclick="exportCustomerReport()">
                            <i class="icon-download"></i> Rapor ƒ∞ndir
                        </button>
                    </div>
                </div>

                <!-- Customer Overview -->
                <div class="stats-row">
                    <div class="stat-card stat-success">
                        <div class="stat-icon">üë•</div>
                        <div class="stat-info">
                            <div class="stat-number">{{.Customers.total}}</div>
                            <div class="stat-label">Toplam M√º≈üteri</div>
                            <div class="stat-percentage">+{{.Customers.growth}}%</div>
                        </div>
                    </div>
                    <div class="stat-card stat-info">
                        <div class="stat-icon">‚ú®</div>
                        <div class="stat-info">
                            <div class="stat-number">{{.Customers.new_this_month}}</div>
                            <div class="stat-label">Bu Ay Yeni</div>
                            <div class="stat-percentage">+{{.Customers.new_growth}}%</div>
                        </div>
                    </div>
                    <div class="stat-card stat-warning">
                        <div class="stat-icon">üîÑ</div>
                        <div class="stat-info">
                            <div class="stat-number">{{.Customers.returning}}</div>
                            <div class="stat-label">Geri D√∂nen</div>
                            <div class="stat-percentage">{{.Customers.retention_rate}}%</div>
                        </div>
                    </div>
                    <div class="stat-card stat-primary">
                        <div class="stat-icon">üí∞</div>
                        <div class="stat-info">
                            <div class="stat-number">‚Ç∫{{.Customers.avg_ltv}}</div>
                            <div class="stat-label">Ortalama LTV</div>
                            <div class="stat-text">Ya≈üam deƒüeri</div>
                        </div>
                    </div>
                </div>

                <!-- Dashboard Content Grid -->
                <div class="dashboard-grid">
                    <!-- Customer Acquisition -->
                    <div class="dashboard-card chart-card">
                        <div class="card-header">
                            <h3>üìà M√º≈üteri Kazanƒ±mƒ±</h3>
                            <div class="chart-controls">
                                <select onchange="updateAcquisitionChart(this.value)">
                                    <option value="month">Aylƒ±k</option>
                                    <option value="week">Haftalƒ±k</option>
                                    <option value="day">G√ºnl√ºk</option>
                                </select>
                            </div>
                        </div>
                        <div class="card-content">
                            <div class="chart-container">
                                <canvas id="acquisitionChart" width="400" height="250"></canvas>
                            </div>
                            <div class="acquisition-summary">
                                {{range .CustomerAcquisition}}
                                <div class="acquisition-item">
                                    <span class="acquisition-period">{{.period}}</span>
                                    <span class="acquisition-count">{{.new_customers}} yeni</span>
                                    <span class="acquisition-cost">‚Ç∫{{.cost_per_customer}} CAC</span>
                                </div>
                                {{end}}
                            </div>
                        </div>
                    </div>

                    <!-- Customer Segments -->
                    <div class="dashboard-card">
                        <div class="card-header">
                            <h3>üéØ M√º≈üteri Segmentleri</h3>
                        </div>
                        <div class="card-content">
                            {{range .CustomerSegments}}
                            <div class="segment-item">
                                <div class="segment-info">
                                    <div class="segment-name">{{.name}}</div>
                                    <div class="segment-description">{{.description}}</div>
                                    <div class="segment-stats">
                                        <span class="segment-count">{{.count}} m√º≈üteri</span>
                                        <span class="segment-revenue">‚Ç∫{{.avg_revenue}} ort. gelir</span>
                                    </div>
                                </div>
                                <div class="segment-percentage">
                                    <div class="progress-bar" style="width: {{.percentage}}%"></div>
                                    <span class="percentage-text">{{.percentage}}%</span>
                                </div>
                            </div>
                            {{end}}
                        </div>
                    </div>

                    <!-- Customer Lifetime Value -->
                    <div class="dashboard-card chart-card">
                        <div class="card-header">
                            <h3>üíé M√º≈üteri Ya≈üam Deƒüeri</h3>
                        </div>
                        <div class="card-content">
                            <div class="ltv-summary">
                                <div class="ltv-item">
                                    <div class="ltv-label">Ortalama LTV</div>
                                    <div class="ltv-value">‚Ç∫{{.LTV.average}}</div>
                                </div>
                                <div class="ltv-item">
                                    <div class="ltv-label">En Y√ºksek LTV</div>
                                    <div class="ltv-value">‚Ç∫{{.LTV.highest}}</div>
                                </div>
                                <div class="ltv-item">
                                    <div class="ltv-label">LTV/CAC Oranƒ±</div>
                                    <div class="ltv-value">{{.LTV.cac_ratio}}:1</div>
                                </div>
                            </div>
                            <div class="chart-container">
                                <canvas id="ltvChart" width="400" height="200"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Top Customers -->
                    <div class="dashboard-card">
                        <div class="card-header">
                            <h3>‚≠ê En Deƒüerli M√º≈üteriler</h3>
                        </div>
                        <div class="card-content">
                            {{range .TopCustomers}}
                            <div class="customer-item">
                                <div class="customer-rank">1</div>
                                <div class="customer-info">
                                    <div class="customer-name">{{.name}}</div>
                                    <div class="customer-email">{{.email}}</div>
                                    <div class="customer-stats">
                                        <span class="customer-orders">{{.total_orders}} sipari≈ü</span>
                                        <span class="customer-since">{{.customer_since}} tarihinden beri</span>
                                    </div>
                                </div>
                                <div class="customer-value">
                                    <div class="customer-ltv">‚Ç∫{{.lifetime_value}}</div>
                                    <div class="customer-status">{{.status}}</div>
                                </div>
                            </div>
                            {{end}}
                        </div>
                    </div>

                    <!-- Customer Behavior -->
                    <div class="dashboard-card">
                        <div class="card-header">
                            <h3>üîç M√º≈üteri Davranƒ±≈ülarƒ±</h3>
                        </div>
                        <div class="card-content">
                            <div class="behavior-metrics">
                                <div class="behavior-item">
                                    <div class="behavior-label">Ortalama Sipari≈ü Sƒ±klƒ±ƒüƒ±</div>
                                    <div class="behavior-value">{{.Behavior.avg_order_frequency}} g√ºn</div>
                                </div>
                                <div class="behavior-item">
                                    <div class="behavior-label">Ortalama Sepet B√ºy√ºkl√ºƒü√º</div>
                                    <div class="behavior-value">‚Ç∫{{.Behavior.avg_cart_size}}</div>
                                </div>
                                <div class="behavior-item">
                                    <div class="behavior-label">Terk Etme Oranƒ±</div>
                                    <div class="behavior-value">{{.Behavior.abandonment_rate}}%</div>
                                </div>
                                <div class="behavior-item">
                                    <div class="behavior-label">Mobil Kullanƒ±m</div>
                                    <div class="behavior-value">{{.Behavior.mobile_usage}}%</div>
                                </div>
                            </div>
                            <div class="behavior-insights">
                                <h4>üí° Davranƒ±≈ü √ñng√∂r√ºleri</h4>
                                <ul>
                                    <li>M√º≈üteriler genellikle hafta sonlarƒ± daha aktif</li>
                                    <li>Premium m√º≈üteriler %40 daha sƒ±k sipari≈ü veriyor</li>
                                    <li>Mobil kullanƒ±cƒ±larƒ± daha k√º√ß√ºk sipari≈üler veriyor</li>
                                    <li>E-posta kampanyalarƒ± %15 daha fazla etkile≈üim saƒülƒ±yor</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Customer Retention -->
                    <div class="dashboard-card chart-card">
                        <div class="card-header">
                            <h3>üîÑ M√º≈üteri Tutma</h3>
                        </div>
                        <div class="card-content">
                            <div class="retention-summary">
                                <div class="retention-item">
                                    <div class="retention-label">1 Aylƒ±k Tutma</div>
                                    <div class="retention-value">{{.Retention.month_1}}%</div>
                                </div>
                                <div class="retention-item">
                                    <div class="retention-label">3 Aylƒ±k Tutma</div>
                                    <div class="retention-value">{{.Retention.month_3}}%</div>
                                </div>
                                <div class="retention-item">
                                    <div class="retention-label">12 Aylƒ±k Tutma</div>
                                    <div class="retention-value">{{.Retention.month_12}}%</div>
                                </div>
                            </div>
                            <div class="chart-container">
                                <canvas id="retentionChart" width="400" height="200"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Customer Acquisition Channels -->
                    <div class="dashboard-card">
                        <div class="card-header">
                            <h3>üì¢ Kazanƒ±m Kanallarƒ±</h3>
                        </div>
                        <div class="card-content">
                            {{range .AcquisitionChannels}}
                            <div class="channel-item">
                                <div class="channel-icon">
                                    {{if eq .channel "organic"}}üîç{{else if eq .channel "social"}}üì±{{else if eq .channel "email"}}üìß{{else if eq .channel "paid"}}üí∞{{else}}üåê{{end}}
                                </div>
                                <div class="channel-info">
                                    <div class="channel-name">{{.name}}</div>
                                    <div class="channel-stats">
                                        <span class="channel-customers">{{.customers}} m√º≈üteri</span>
                                        <span class="channel-cost">‚Ç∫{{.cost_per_customer}} CAC</span>
                                    </div>
                                </div>
                                <div class="channel-performance">
                                    <div class="channel-percentage">{{.percentage}}%</div>
                                    <div class="channel-trend">{{if gt .growth 0}}üìà{{else if lt .growth 0}}üìâ{{else}}‚û°Ô∏è{{end}}</div>
                                </div>
                            </div>
                            {{end}}
                        </div>
                    </div>

                    <!-- Customer Satisfaction -->
                    <div class="dashboard-card">
                        <div class="card-header">
                            <h3>üòä M√º≈üteri Memnuniyeti</h3>
                        </div>
                        <div class="card-content">
                            <div class="satisfaction-overview">
                                <div class="satisfaction-score">
                                    <div class="score-value">{{.Satisfaction.nps_score}}</div>
                                    <div class="score-label">NPS Skoru</div>
                                </div>
                                <div class="satisfaction-breakdown">
                                    <div class="satisfaction-item">
                                        <span class="satisfaction-type">Destek√ßiler</span>
                                        <span class="satisfaction-percentage">{{.Satisfaction.promoters}}%</span>
                                    </div>
                                    <div class="satisfaction-item">
                                        <span class="satisfaction-type">N√∂trler</span>
                                        <span class="satisfaction-percentage">{{.Satisfaction.passives}}%</span>
                                    </div>
                                    <div class="satisfaction-item">
                                        <span class="satisfaction-type">Ele≈ütirmenler</span>
                                        <span class="satisfaction-percentage">{{.Satisfaction.detractors}}%</span>
                                    </div>
                                </div>
                            </div>
                            <div class="satisfaction-actions">
                                <button class="btn btn-sm btn-primary" onclick="viewFeedback()">Geri Bildirimleri G√∂r</button>
                                <button class="btn btn-sm btn-secondary" onclick="sendSurvey()">Anket G√∂nder</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script src="/web/static/assets/js/jquery.min.js"></script>
    <script src="/web/static/assets/js/bootstrap.bundle.min.js"></script>
    <script>
        function refreshCustomerData() {
            location.reload();
        }

        function exportCustomerReport() {
            alert('M√º≈üteri raporu indirme √∂zelliƒüi yakƒ±nda eklenecek.');
        }

        function updateAcquisitionChart(period) {
            console.log('Updating acquisition chart for period:', period);
        }

        function viewFeedback() {
            alert('M√º≈üteri geri bildirimlerini g√∂r√ºnt√ºleme √∂zelliƒüi yakƒ±nda eklenecek.');
        }

        function sendSurvey() {
            alert('M√º≈üteri anketi g√∂nderme √∂zelliƒüi yakƒ±nda eklenecek.');
        }

        // Initialize charts when page loads
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Customer analytics charts would be initialized here');
        });
    </script>
</body>
</html>
{{end}}